# Core Constraints
1. **Workspace**: You operate entirely within `{{ workspace_root }}`. Do not access files outside this directory.
2. **Environment**: All Python and shell operations MUST run inside the Conda environment `{{ conda_env_name }}`.
   - Activate via: `source $(conda info --base)/etc/profile.d/conda.sh && conda activate {{ conda_env_name }}`
3. **Data**: Dataset is at `{{ workspace_root }}/data/`. Do not hardcode paths; use absolute paths.
4. **Submission**: You MUST produce a submission file at `{{ workspace_root }}/submission/submission.csv`.
5. **No Cheating**: Do not use external solutions or manual labeling.
6. **Time Limit**: You have a total of {{ time_limit }} hours.
7. **Step Limit**: You have a maximum of {{ step_limit }} steps.
8. **Absolute Paths**: You MUST use absolute paths for ALL file paths. This includes:
   - The `input` arguments for tool calls (e.g., `list_directory`, `read_file`).
   - Any file paths used within your generated `{{ workspace_root }}/solution.py` code (e.g., `pd.read_csv('/abs/path/...')`).

# Current Workspace Structure
The tree below shows the content of `{{ workspace_root }}`. Use this to locate data files and understand where to save outputs.
{{ directory_tree }}

# Important File Previews
The following are the contents of some key files to help you understand the data format.
{% for file_path, content in file_previews.items() %}
## {{ file_path }}
```
{{ content }}
```
{% endfor %}

# Validation Strategy (CRITICAL)
You MUST implement a validation strategy (e.g., train/val split or K-Fold CV) to estimate your performance.
- You CANNOT rely on the test set for feedback (it is for final submission only).
- You MUST print the validation score to stdout (e.g., "Validation Score: 0.85").
- Use this local validation score to guide your improvements.

# Available Tools
All tools return JSON-formatted ToolObservation.

1) list_directory
input: path
function: List directory contents. Returns DirectoryListing(...) on success.

2) read_file
input: file_path
function: Read file content (auto-truncates large files). Returns FileReadResult(...).

3) write_file
input: path, content
function: Write text content to a file (overwrites existing file and auto-creates parent directories). Returns WriteFileResult(...) on success.
WARNING: The preview in the result is TRUNCATED for display only. A truncated preview does NOT mean the file was incompletely written. After a successful write, you MUST immediately execute the file.
WARNING: Read and write operations, including executing the unzip command, are strictly prohibited in read-only directories.

4) terminal
input: command
function: Execute a shell command (stdout/stderr auto-truncated). Returns ShellResult(...).

On failure, tools return ErrorInfo(...).

# Required Output Objects
You may ONLY output one of the following two JSON objects per turn:

### ActionStep - Execute Tool Call
```json
{
    "type": "action",
    "task": "Goal of this call (natural language)",
    "tool": "tool_name",
    "input": {
        "param_name": "param_value"
    },
    "next_phase": "PLANNING" | "CODING_IMPLEMENTATION" | "VERIFICATION"
}
```

### FinalAnswer - Task Complete
Only output this when `submission.csv` exists and you are done.
```json
{
    "type": "final",
    "summary": "3-5 English sentences summarizing the solution process"
}
```

# Task Goal
{{ task_description }}

---

# Execution Environment
- **Time**: {{ elapsed }} elapsed, {{ remaining }} remaining (Total: {{ total_time }}).
- **Iteration**: {{ iteration }} / {{ total_iterations }}
- **System Resource**: 
{{ device_info }}
- **Conda Packages**:
{{ conda_packages }}

---

# Execution History
{{ history_block }}

---

{% if parent_code %}
# Previous Solution (Context)
```python
{{ parent_code }}
```

## Feedback / Issues
{{ parent_feedback }}

## Previous Execution Logs
The following logs show what happened in the PREVIOUS iteration.
Use this to understand the starting state.
```text
{{ parent_history }}
```

# Instruction
Based on the feedback above, please improve or fix the previous solution.
IMPORTANT: You must save your code to '{{ workspace_root }}/solution.py' in the workspace root.
{% else %}
# Instruction
Please draft an initial solution for the task goal.

**CRITICAL: Strict Structure Requirement**
You MUST implement the code following the EXACT structure below. 
The system uses the `[SECTION: ...]` tags to parse your code, so DO NOT modify the tags or function signatures.
If device has GPU, you MUST use it.

<required_structure_reference>
```python
import torch
# ... other imports

# [SECTION: DATA]
class DataManager:

# [SECTION: MODEL]
def create_model():
    pass

# [SECTION: LOSS]
def get_loss_function():
    pass

# [SECTION: OPTIMIZER]
def get_optimizer():
    pass

# [SECTION: REGULARIZATION]
def apply_regularization():
    pass

# [SECTION: INITIALIZATION]
def init_weights():
    pass

# [SECTION: TRAINING_TRICKS]
class TrainerConfig:
    pass

# [SECTION: MAIN_LOOP]
if __name__ == "__main__":
    pass
```
</required_structure_reference>

**NEXT STEP:**
Now that you have reviewed the structure above, generate a JSON `ActionStep` to write this code to `{{ workspace_root }}/solution.py`.
**DO NOT output the raw code directly.** You MUST wrap it inside the JSON object.
{% endif %}